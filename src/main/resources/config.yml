# KedamaSurvivors Configuration
# Version: 1.0.0
# Documentation: https://github.com/NyaaCat/KedamaSurvivors/wiki

# ============================================================
# Plugin Settings
# ============================================================
plugin:
  language: zh_CN
  verbose: false

# ============================================================
# Join Switch (Global game entry control)
# ============================================================
joinSwitch:
  enabled: true
  graceEjectSeconds: 60
  graceWarningInterval: 15

# ============================================================
# Ready & Countdown
# ============================================================
ready:
  countdownSeconds: 5
  showActionBar: true
  showTitle: true
  countdownSound: BLOCK_NOTE_BLOCK_PLING
  countdownSoundPitch: 1.0
  teleportSound: ENTITY_ENDERMAN_TELEPORT

# ============================================================
# Cooldown
# ============================================================
cooldown:
  deathCooldownSeconds: 60
  quitCooldownSeconds: 30
  showCooldownBar: true
  displayUpdateTicks: 20

# ============================================================
# Disconnect Handling
# ============================================================
disconnect:
  graceSeconds: 300
  checkIntervalTicks: 200
  notifyTeam: true
  notifyGraceExpired: true

# ============================================================
# Team Settings
# ============================================================
teams:
  maxSize: 5
  inviteExpirySeconds: 60

# ============================================================
# Respawn Settings
# ============================================================
respawn:
  invulnerabilitySeconds: 3
  canDealDamageDuringInvul: false
  invulEffect: GLOWING
  pvp: false  # Whether players can damage each other (false = PVP disabled, damage set to 0)

# ============================================================
# Combat Worlds
# ============================================================
# Note: World list is now stored in data/worlds.yml
worlds:
  spawnSampling:
    maxAttempts: 50
    unsafeBlocks:
      - LAVA
      - WATER
      - CACTUS
      - MAGMA_BLOCK
      - FIRE
      - SOUL_FIRE
    requiredHeadroom: 2

# ============================================================
# Teleport Settings
# ============================================================
teleport:
  # Lobby location - where players go when quitting or after death
  lobbyWorld: "world"
  lobbyX: 0
  lobbyY: 64
  lobbyZ: 0
  # Optional commands - API handles teleportation, these are for extra setup only
  # Use {player}, {world}, {x}, {y}, {z}, {yaw}, {pitch} placeholders
  prepCommand: ""
  enterCommand: ""
  respawnCommand: ""
  # Maximum offset in blocks for spreading team spawn positions (prevents players stacking)
  teamSpawnOffsetRange: 2.0

# ============================================================
# Starter Selection
# ============================================================
# Note: Starter weapon/helmet options are now stored in data/starters.yml
starterSelection:
  requireWeaponFirst: true
  autoOpenHelmetGui: true

# ============================================================
# Inventory Rules
# ============================================================
# Note: Drop/pickup prevention is now hardcoded for all modes except LOBBY
# Equipment pools are now stored in data/equipment/weapons.yml and data/equipment/helmets.yml
inventoryRules:
  lockEquipmentSlots: true
  weaponSlotIndex: 0
  rewards:
    overflowMode: PENDING_QUEUE
    pendingFlushInterval: 100
    maxPendingItems: 100

# ============================================================
# Progression
# ============================================================
progression:
  baseXpRequired: 100
  xpPerLevelIncrease: 50
  xpMultiplierPerLevel: 1.1
  weaponLevelWeight: 1
  helmetLevelWeight: 1

  overflow:
    enabled: true
    xpPerPermaScore: 1000
    notifyPlayer: true

  maxLevelBehavior:
    mode: GRANT_PERMA_SCORE
    permaScoreReward: 10

# ============================================================
# Upgrade Selection (Chat-based, non-intrusive)
# ============================================================
upgrade:
  # Timeout before auto-selection (seconds)
  timeoutSeconds: 30
  # Interval between chat reminders (seconds)
  reminderIntervalSeconds: 5
  # Perma-score reward when both weapon and helmet are at max level
  bothMaxPermaReward: 10

# ============================================================
# Enemy Spawning
# ============================================================
# Note: Archetypes are now stored in data/archetypes.yml
spawning:
  loop:
    tickInterval: 20
    enabled: true
    blockNaturalSpawns: true  # Block natural mob spawns in combat worlds

  limits:
    targetMobsPerPlayer: 10
    maxSpawnsPerPlayerPerTick: 3
    maxSpawnsPerTick: 20
    maxCommandsPerTick: 50
    mobCountRadius: 30.0

  positioning:
    minSpawnDistance: 8.0
    maxSpawnDistance: 25.0
    maxSampleAttempts: 10
    # Vertical range for mob spawning - mobs spawn within ±N blocks of player's Y level
    verticalRange: 10

  levelCalculation:
    levelSamplingRadius: 50.0
    avgLevelMultiplier: 1.0
    playerCountMultiplier: 0.2
    levelOffset: 0
    minLevel: 1
    maxLevel: 100
    timeScaling:
      enabled: true
      timeStepSeconds: 60
      levelPerStep: 1

  mobIdentification:
    mobTag: "vrs_mob"
    levelTagPattern: "vrs_lvl_(\\d+)"
    defaultLevel: 1

# ============================================================
# Rewards
# ============================================================
rewards:
  # Proximity-based XP sharing: players nearby the death location receive XP
  xpShare:
    enabled: true
    radius: 20.0
    sharePercent: 0.25

  # Damage contribution XP sharing: players who damaged the mob receive XP
  # Works independently of xpShare - players can receive from both systems
  damageContribution:
    enabled: true
    sharePercent: 0.10  # 10% of base XP to each contributor

  coin:
    material: EMERALD
    customModelData: 0
    displayName: "§e金币"

# ============================================================
# Merchants
# ============================================================
# Note: Merchant pools are now stored in data/merchant_pools.yml
merchants:
  enabled: true

  # Wandering merchant spawning behavior
  wandering:
    spawnIntervalSeconds: 120    # How often to attempt spawning
    spawnChance: 0.5             # Probability of spawn per interval (0-1)
    maxCount: 3                  # Maximum wandering merchants at once (0 = unlimited)
    stayTime:
      minSeconds: 60             # Minimum stay duration
      maxSeconds: 120            # Maximum stay duration
    distance:
      min: 20.0                  # Min distance from players
      max: 50.0                  # Max distance from players
    particles:
      spawn: true                # Show particles when merchant appears
      despawn: true              # Show particles when merchant leaves

  # Merchant stock settings
  stock:
    limited: true                # Items disappear when purchased (true) or respawn (false)
    minItems: 3                  # Min items in shop (for multi-type)
    maxItems: 6                  # Max items in shop (for multi-type)

  # Display settings (armor stand animation)
  display:
    rotationSpeed: 3.0           # Degrees per tick
    bobHeight: 0.15              # Floating bob amplitude (blocks)
    bobSpeed: 0.01               # Floating bob speed
    headItemCycleIntervalTicks: 200  # How often head item changes (for multi-type)

# ============================================================
# Economy
# ============================================================
economy:
  # Mode: VAULT (external economy), INTERNAL (plugin-managed per-player), ITEM (physical items)
  mode: INTERNAL

  # Coin item settings (used for ITEM mode and visual display)
  coin:
    material: EMERALD
    customModelData: 0
    displayName: "§e金币"
    nbtTag: "vrs_coin"           # NBT tag to identify VRS coins

  permaScore:
    objectiveName: "vrs_perma"
    displayName: "永久积分"

# ============================================================
# Scoreboard
# ============================================================
scoreboard:
  enabled: true
  title: "§6§l毛 玉 幸 存 者"
  updateInterval: 10

# ============================================================
# Persistence
# ============================================================
persistence:
  saveIntervalSeconds: 300
  saveOnQuit: true
  saveOnRunEnd: true

  paths:
    items: "data/items"
    runtime: "data/runtime"

  backup:
    enabled: true
    intervalHours: 6
    maxBackups: 10

# ============================================================
# Templates
# ============================================================
templates:
  escaping:
    enabled: true
    escapeChars: ";&|`$\\"
  missingPlaceholder:
    mode: ERROR

# ============================================================
# Feedback & Notifications
# ============================================================
feedback:
  # Reward display settings
  rewards:
    # Display mode: ACTIONBAR (stacked action bar) or CHAT (individual messages)
    displayMode: ACTIONBAR
    # Stacking settings (only applies to ACTIONBAR mode)
    stacking:
      enabled: true
      # Time window in seconds - rewards aggregate within this period
      timeoutSeconds: 3

  # Upgrade reminder settings
  upgradeReminder:
    # Display mode: CHAT (clickable messages) or SCOREBOARD (flashing line)
    displayMode: CHAT
    # Scoreboard flash interval in ticks (only for SCOREBOARD mode)
    flashIntervalTicks: 10

  # Sound effects
  # Format: "sound_name volume pitch" or empty string to disable
  # Uses vanilla Minecraft sound format (e.g., minecraft:entity.experience_orb.pickup)
  sounds:
    # Reward sounds
    xpGained: "minecraft:entity.experience_orb.pickup 0.5 1.2"
    coinGained: "minecraft:entity.item.pickup 0.6 1.0"
    permaScoreGained: "minecraft:entity.player.levelup 0.8 1.0"
    killReward: ""  # Empty = disabled (XP sound covers this)
    # Upgrade sounds
    upgradeAvailable: "minecraft:block.note_block.pling 1.0 1.2"
    upgradeSelected: "minecraft:entity.player.levelup 1.0 1.0"
    # Game event sounds
    countdownTick: "minecraft:block.note_block.pling 0.8 1.0"
    teleport: "minecraft:entity.enderman.teleport 0.8 1.0"
    death: "minecraft:entity.wither.death 0.5 1.0"
    runStart: "minecraft:entity.player.levelup 1.0 1.0"

# ============================================================
# Debug
# ============================================================
debug:
  enabled: false
  logLevel: INFO
  separateLogFile: true
  performance:
    enabled: true
    slowOperationThreshold: 50
    showInDebugCommand: true
